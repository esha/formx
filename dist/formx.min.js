/*! formx - v0.2.0 - 2014-08-13
* http://esha.github.io/formx/
* Copyright (c) 2014 ESHA Research; Licensed MIT, GPL */
!function(a,b){"use strict";var c=window.FORMx={},d=c.validate={type:{number:/^\-?\d*(\.\d+)?$/,email:/^[a-zA-Z0-9.!#$%&'*+-\/=?\^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,url:/^http.[^\s]+$/i},constraints:{required:function(a){return!(a&&a.trim())},pattern:function(a,b){return a&&!a.match(new RegExp("^"+b+"$"))},"equal-to":function(a,b){return a!==d.valueOf(b)},"not-equal":function(a,b){return a===d.valueOf(b)},maxlength:function(a,b){return a.length>parseInt(b,10)},minlength:function(a,b){return a&&a.length<parseInt(b,10)},min:function(a,b){return d.parse(a)<d.parse(b)},max:function(a,b){return d.parse(a)>d.parse(b)},step:function(a,b){var c=b.indexOf("."),d=1;if(c>=0){var e=b.length-c-1;d=Math.pow(10,e)}b=Math.round(parseFloat(b)*d);var f=Math.round(a*d)%b;return!isNaN(f)&&0!==f}},classes:{required:"valueMissing",pattern:"patternMismatch","equal-to":"notEqual","not-equal":"notDifferent",maxlength:"tooLong",minlength:"tooShort",min:"rangeUnderflow",max:"rangeOverflow",step:"stepMismatch"},field:"[type=number],[type=email],[type=url],[required],[pattern],[maxlength],[min],[max],[step],[equal-to],[not-equal],[minlength]",toggle:function(a,b){a.classList.toggle("invalid",!b),a.setCustomValidity(b?"":"Invalid field.")},valueOf:function(b){if(b){var c=a.query('[name="'+b+'"]');b=c&&c.value}return b},parse:function(a){return parseFloat(d.valueOf(a))},check:function(a,b){var c=a.getAttribute("novalidate");return c?"true"===c||"novalidate"===c?!1:0===c.indexOf("!")?-1!==c.substring(1).split().indexOf(b):-1===c.split(" ").indexOf(b):!0},one:function(a,b){if(!d.check(a,b))return!0;var c=d.type[a.getAttribute("type")],e=a.value,f=!0;c&&(f=!e||!!e.match(c),a.classList.toggle("typeMismatch",!f));for(var g in d.constraints){var h=a.getAttribute(g);if(h){var i=d.classes[g],j=d.constraints[g](e,h);j&&(f=!1),a.classList.toggle(i,j)}}return d.toggle(a,f),f&&(a.lastValidValue=e),f},all:function(a,c){if(!d.check(a,c))return!0;var e=!0;if(a.queryAll(d.field).each(function(a){d.one(a,c)||(e=!1)}),a.classList.toggle("invalid",!e),b.fire(a,e?"valid":"invalid"),!e){var f=a.query(".invalid");f&&f.focus()}return e}};b.on("^ready",function(){a.queryAll("form").each(function(){d.all(this,"ready")}),a.queryAll("[required]").each("aria-required",!0)}),b.on("keyup submit validate",function(a,c){if(9!==a.keyCode){var e=a.target,f=!0;return c=c&&"string"==typeof c?c:a.type,e.matches(d.field)?f=d.one(e,c):("submit"===c||"validate"===c)&&(f=d.all(b._.closest(e,"form"),c)),f}}),b.on("focusout<[restrict]>",function(a){var c=a.target;if(c.matches(".invalid")){var d=c.value;return c.value=c.lastValidValue||c.getAttribute("value")||"",b.fire(c,"restricted",d),setTimeout(function(){c.focus()},0),!1}});var e=c.ajaxForm={selector:"form[ajax]",init:function(){a.queryAll(e.selector).each(function(a){"ready"!==a.getAttribute("ajax")&&(a.setAttribute("ajax","ready"),a.addEventListener("submit",e.block))})},block:function(a){a.preventDefault()}};e.init(),a.addEventListener("DOMContentLoaded",e.init);var f=c.flexTextarea={selector:"textarea[flex]",events:"input onpropertychange change",adjust:function(a,b){var c=a.scrollHeight,d=a.style;c>a.offsetHeight-2?d.height=c+"px":b||(d.height="",f.adjust(a,!0));var e=a.scrollWidth;e>a.offsetWidth?d.width=e+"px":b||(d.width="",f.adjust(a,!0))}};f.events.split(" ").forEach(function(c){b.on(a.body,c+"<"+f.selector+">",function(){f.adjust(this)})})}(document,Eventi);